(()=>{"use strict";var e;function t(e){let t=e.target.closest("button").getAttribute("data-url");fetch("http://localhost:5000/videos",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({videoUrl:t})}).then((e=>{console.debug(`res ${JSON.stringify(e)}`),console.debug(`posturl ${t}`);let n=document.createElement("a");n.setAttribute("download",t),n.href=e.url,n.target="_blank",n.click()})).catch((e=>console.error(e)))}function n(e){let n=document.getElementById("video-list"),d=document.createElement("li"),o=document.createElement("a"),l=document.createElement("div"),a=document.createElement("div"),i=document.createElement("button"),c=document.createElement("img");c.src=e.thumb,a.id="img-container",l.id="list-container",o.href=e.url,o.text=e.desc,i.textContent="Download",i.id="btn-download",i.setAttribute("data-url",e.videoUrl),i.addEventListener("click",t),a.appendChild(c),d.appendChild(o),d.appendChild(a),d.appendChild(i),l.appendChild(d),null==n||n.prepend(l)}null===(e=document.getElementById("clear-downloads"))||void 0===e||e.addEventListener("click",(()=>{console.debug("Clearing downloads..."),chrome.storage.local.clear(),window.location.reload()})),chrome.storage.local.get("posts",(e=>{!function(e){console.debug(`updating last video with ${JSON.stringify(e)}`);let n=document.getElementById("last-video-header"),d=document.createElement("div"),o=document.createElement("h2");o.textContent="Last video to download",d.appendChild(o);let l=document.createElement("a");l.id="last-video-referent",l.target="_blank",l.textContent=e.desc,l.href=e.url,d.appendChild(l);let a=document.createElement("div"),i=document.createElement("img");i.src=e.thumb,a.append(i),a.id="img-container-header",d.appendChild(a);let c=document.createElement("button");c.id="btn-download",c.setAttribute("data-url",e.videoUrl),c.setAttribute("download",e.desc),c.textContent="Download",c.addEventListener("click",t),d.appendChild(c),null==n||n.appendChild(d)}(e.posts[e.posts.length-1]);for(let t=0;t<e.posts.length-1;t++)n(e.posts[t])}))})();